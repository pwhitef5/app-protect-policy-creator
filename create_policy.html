<!DOCTYPE html>
<html>
    <head>
        <title>NGINX App Protect Policy Creator</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <script>
            function showHide(id,div) {
                if (document.getElementById(id).checked) {
                    document.getElementById(div).style.display = "block"
                } else {
                    document.getElementById(div).style.display = "none"
                }
            }
            function addrow(template,table) {
                var templateText = document.getElementById(template).innerHTML;
                // insert a row
                var tableLength = document.getElementById(table).rows.length - 2;
                var newRow = document.getElementById(table).insertRow(document.getElementById(table).rows.length - 1);        
                newRow.innerHTML = templateText
                //
                var newId = template + "-" + tableLength;
                newRow.id = newId;
            }
            function deleterow(btn) {
                //console.log("btn:" + this)
                var row = btn.parentNode.parentNode;
                //console.log("row:" + row)
                row.parentNode.removeChild(row);
            }
            function export2txt() {
                var content = document.getElementById("output").innerHTML;
                const a = document.createElement("a");
                    a.href = URL.createObjectURL(new Blob([content], {
                    type: "text/plain"
                }));
                a.setAttribute("download", "policy.json");
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                return false;
            }
        </script>
    </head>
<body>

<div class="w3-container w3-card-4"></div>
    <div class="w3-container">
        <div class="w3-row">
            <div class="w3-half">
                <h1 class="w3-center">NGINX App Protect Policy Creator</h1>
            </div>
        </div>
        <div class="w3-row">
    
        <div class="w3-half w3-green w3-padding-16">
            <h2 class="w3-center">Policy Details</h2>
            <form name="policyConfig" class="w3-container">
                <label><b>Policy Name</b></label>
                <input class="w3-input" type="text" name="policyName" id="policyName" value="myPolicyName">
                <label><b>Description</b></label>
                <input class="w3-input w3-border" type="text" name="policyDescription" id="policyDescription">
                <label><b>Application Language</b></label>
                <select class="w3-input w3-border" name="policyApplicationLanguage" id="policyApplicationLanguage">
                    <option value="utf-8" selected>utf-8</option>
                    <option value="big5">big5</option>
                    <option value="euc-jp">euc-jp</option>
                    <option value="euc-kr">euc-kr</option>
                    <option value="gb18030">gb18030</option>
                    <option value="gb2312">gb2312</option>
                    <option value="gbk">gbk</option>
                    <option value="iso-8859-1">iso-8859-1</option>
                    <option value="iso-8859-10">iso-8859-10</option>
                    <option value="iso-8859-13">iso-8859-13</option>
                    <option value="iso-8859-15">iso-8859-15</option>
                    <option value="iso-8859-16">iso-8859-16</option>
                    <option value="iso-8859-2">iso-8859-2</option>
                    <option value="iso-8859-3">iso-8859-3</option>
                    <option value="iso-8859-4">iso-8859-4</option>
                    <option value="iso-8859-5">iso-8859-5</option>
                    <option value="iso-8859-6">iso-8859-6</option>
                    <option value="iso-8859-7">iso-8859-7</option>
                    <option value="iso-8859-8">iso-8859-8</option>
                    <option value="iso-8859-9">iso-8859-9</option>
                    <option value="koi8-r">koi8-r</option>
                    <option value="shift_jis">shift_jis</option>
                    <option value="utf-8">utf-8</option>
                    <option value="windows-1250">windows-1250</option>
                    <option value="windows-1251">windows-1251</option>
                    <option value="windows-1252">windows-1252</option>
                    <option value="windows-1253">windows-1253</option>
                    <option value="windows-1255">windows-1255</option>
                    <option value="windows-1256">windows-1256</option>
                    <option value="windows-1257">windows-1257</option>
                    <option value="windows-874">windows-874</option>
                </select>
                <label><b>Enforcement Mode</b></label>
                <select class="w3-input w3-border" name="policyEnforcementMode" id="policyEnforcementMode">
                    <option value="blocking" selected>Blocking</option>
                    <option value="transparent">Transparent</option>
                </select>
                <h3>Violations [<a style="text-decoration: none;" href="#" onclick="javascript:document.getElementById('violationsTable').style.display = 'block';return false;">+</a>]</h3>
                <table id="violationsTable" class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Violation Name</th>
                            <th>Alarm</th>
                            <th>Block</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>VIOL_ASM_COOKIE_MODIFIED</td>
                            <td><input type="checkbox" id="VIOL_ASM_COOKIE_MODIFIED_alarm" name="VIOL_ASM_COOKIE_MODIFIED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_ASM_COOKIE_MODIFIED_block" name="VIOL_ASM_COOKIE_MODIFIED" value="block"></td>
                        </tr>
                        <!--
                        <tr>
                            <td>VIOL_ATTACK_SIGNATURE</td>
                            <td><input type="checkbox" id="VIOL_ATTACK_SIGNATURE_alarm" name="VIOL_ATTACK_SIGNATURE" value="alarm"></td>
                            <td><input type="checkbox" id="VIOL_ATTACK_SIGNATURE_block" name="VIOL_ATTACK_SIGNATURE" value="block"></td>
                        </tr>
                        -->
                        <tr>
                            <td>VIOL_BLACKLISTED_IP</td>
                            <td><input type="checkbox" id="VIOL_BLACKLISTED_IP_alarm" name="VIOL_BLACKLISTED_IP" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_BLACKLISTED_IP_block" name="VIOL_BLACKLISTED_IP" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_COOKIE_EXPIRED</td>
                            <td><input type="checkbox" id="VIOL_COOKIE_EXPIRED_alarm" name="VIOL_COOKIE_EXPIRED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_COOKIE_EXPIRED_block" name="VIOL_COOKIE_EXPIRED" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_COOKIE_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_COOKIE_LENGTH_alarm" name="VIOL_COOKIE_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_COOKIE_LENGTH_block" name="VIOL_COOKIE_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_COOKIE_MALFORMED</td>
                            <td><input type="checkbox" id="VIOL_COOKIE_MALFORMED_alarm" name="VIOL_COOKIE_MALFORMED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_COOKIE_MALFORMED_block" name="VIOL_COOKIE_MALFORMED" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_COOKIE_MODIFIED</td>
                            <td><input type="checkbox" id="VIOL_COOKIE_MODIFIED_alarm" name="VIOL_COOKIE_MODIFIED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_COOKIE_MODIFIED_block" name="VIOL_COOKIE_MODIFIED" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_CSRF</td>
                            <td><input type="checkbox" id="VIOL_CSRF_alarm" name="VIOL_CSRF" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_CSRF_block" name="VIOL_CSRF" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_DATA_GUARD</td>
                            <td><input type="checkbox" id="VIOL_DATA_GUARD_alarm" name="VIOL_DATA_GUARD" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_DATA_GUARD_block" name="VIOL_DATA_GUARD" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_ENCODING</td>
                            <td><input type="checkbox" id="VIOL_ENCODING_alarm" name="VIOL_ENCODING" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_ENCODING_block" name="VIOL_ENCODING" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_EVASION</td>
                            <td><input type="checkbox" id="VIOL_EVASION_alarm" name="VIOL_EVASION" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_EVASION_block" name="VIOL_EVASION" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_FILETYPE</td>
                            <td><input type="checkbox" id="VIOL_FILETYPE_alarm" name="VIOL_FILETYPE" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_FILETYPE_block" name="VIOL_FILETYPE" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_FILE_UPLOAD</td>
                            <td><input type="checkbox" id="VIOL_FILE_UPLOAD_alarm" name="VIOL_FILE_UPLOAD" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_FILE_UPLOAD_block" name="VIOL_FILE_UPLOAD" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_FILE_UPLOAD_IN_BODY</td>
                            <td><input type="checkbox" id="VIOL_FILE_UPLOAD_IN_BODY_alarm" name="VIOL_FILE_UPLOAD_IN_BODY" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_FILE_UPLOAD_IN_BODY_block" name="VIOL_FILE_UPLOAD_IN_BODY" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_GRPC_FORMAT</td>
                            <td><input type="checkbox" id="VIOL_GRPC_FORMAT_alarm" name="VIOL_GRPC_FORMAT" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_GRPC_FORMAT_block" name="VIOL_GRPC_FORMAT" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_GRPC_MALFORMED</td>
                            <td><input type="checkbox" id="VIOL_GRPC_MALFORMED_alarm" name="VIOL_GRPC_MALFORMED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_GRPC_MALFORMED_block" name="VIOL_GRPC_MALFORMED" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_GRPC_METHOD</td>
                            <td><input type="checkbox" id="VIOL_GRPC_METHOD_alarm" name="VIOL_GRPC_METHOD" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_GRPC_METHOD_block" name="VIOL_GRPC_METHOD" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_HEADER_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_HEADER_LENGTH_alarm" name="VIOL_HEADER_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_HEADER_LENGTH_block" name="VIOL_HEADER_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_HEADER_METACHAR</td>
                            <td><input type="checkbox" id="VIOL_HEADER_METACHAR_alarm" name="VIOL_HEADER_METACHAR" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_HEADER_METACHAR_block" name="VIOL_HEADER_METACHAR" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_HTTP_PROTOCOL</td>
                            <td><input type="checkbox" id="VIOL_HTTP_PROTOCOL_alarm" name="VIOL_HTTP_PROTOCOL" value="alarm" checked onChange="showHide(this.id,'http-protocols');"></td>
                            <td><input type="checkbox" id="VIOL_HTTP_PROTOCOL_block" name="VIOL_HTTP_PROTOCOL" value="block" onChange="showHide(this.id,'http-protocols');"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_HTTP_RESPONSE_STATUS</td>
                            <td><input type="checkbox" id="VIOL_HTTP_RESPONSE_STATUS_alarm" name="VIOL_HTTP_RESPONSE_STATUS" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_HTTP_RESPONSE_STATUS_block" name="VIOL_HTTP_RESPONSE_STATUS" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_JSON_FORMAT</td>
                            <td><input type="checkbox" id="VIOL_JSON_FORMAT_alarm" name="VIOL_JSON_FORMAT" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_JSON_FORMAT_block" name="VIOL_JSON_FORMAT" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_JSON_MALFORMED</td>
                            <td><input type="checkbox" id="VIOL_JSON_MALFORMED_alarm" name="VIOL_JSON_MALFORMED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_JSON_MALFORMED_block" name="VIOL_JSON_MALFORMED" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_JSON_SCHEMA</td>
                            <td><input type="checkbox" id="VIOL_JSON_SCHEMA_alarm" name="VIOL_JSON_SCHEMA" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_JSON_SCHEMA_block" name="VIOL_JSON_SCHEMA" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_MANDATORY_HEADER</td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_HEADER_alarm" name="VIOL_MANDATORY_HEADER" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_HEADER_block" name="VIOL_MANDATORY_HEADER" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_MANDATORY_PARAMETER</td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_PARAMETER_alarm" name="VIOL_MANDATORY_PARAMETER" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_PARAMETER_block" name="VIOL_MANDATORY_PARAMETER" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_MANDATORY_REQUEST_BODY</td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_REQUEST_BODY_alarm" name="VIOL_MANDATORY_REQUEST_BODY" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_MANDATORY_REQUEST_BODY_block" name="VIOL_MANDATORY_REQUEST_BODY" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_METHOD</td>
                            <td><input type="checkbox" id="VIOL_METHOD_alarm" name="VIOL_METHOD" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_METHOD_block" name="VIOL_METHOD" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_PARAMETER</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_alarm" name="VIOL_PARAMETER_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_block" name="VIOL_PARAMETER_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_ARRAY_VALUE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_ARRAY_VALUE_alarm" name="VIOL_PARAMETER_ARRAY_VALUE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_ARRAY_VALUE_block" name="VIOL_PARAMETER_ARRAY_VALUE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_DATA_TYPE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_DATA_TYPE_alarm" name="VIOL_PARAMETER_DATA_TYPE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_DATA_TYPE_block" name="VIOL_PARAMETER_DATA_TYPE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_EMPTY_VALUE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_EMPTY_VALUE_alarm" name="VIOL_PARAMETER_EMPTY_VALUE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_EMPTY_VALUE_block" name="VIOL_PARAMETER_EMPTY_VALUE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_LOCATION</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_LOCATION_alarm" name="VIOL_PARAMETER_LOCATION_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_LOCATION_block" name="VIOL_PARAMETER_LOCATION_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_MULTIPART_NULL_VALUE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_MULTIPART_NULL_VALUE_alarm" name="VIOL_PARAMETER_MULTIPART_NULL_VALUE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_MULTIPART_NULL_VALUE_block" name="VIOL_PARAMETER_MULTIPART_NULL_VALUE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_NAME_METACHAR</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_NAME_METACHAR_alarm" name="VIOL_PARAMETER_NAME_METACHAR_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_NAME_METACHAR_block" name="VIOL_PARAMETER_NAME_METACHAR_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_NUMERIC_VALUE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_NUMERIC_VALUE_alarm" name="VIOL_PARAMETER_NUMERIC_VALUE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_NUMERIC_VALUE_block" name="VIOL_PARAMETER_NUMERIC_VALUE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_REPEATED</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_REPEATED_alarm" name="VIOL_PARAMETER_REPEATED_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_REPEATED_block" name="VIOL_PARAMETER_REPEATED_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_STATIC_VALUE</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_STATIC_VALUE_alarm" name="VIOL_PARAMETER_STATIC_VALUE_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_STATIC_VALUE_block" name="VIOL_PARAMETER_STATIC_VALUE_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_VALUE_BASE64</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_BASE64_alarm" name="VIOL_PARAMETER_VALUE_BASE64_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_BASE64_block" name="VIOL_PARAMETER_VALUE_BASE64_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_VALUE_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_LENGTH_alarm" name="VIOL_PARAMETER_VALUE_LENGTH_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_LENGTH_block" name="VIOL_PARAMETER_VALUE_LENGTH_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_VALUE_METACHAR</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_METACHAR_alarm" name="VIOL_PARAMETER_VALUE_METACHAR_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_METACHAR_block" name="VIOL_PARAMETER_VALUE_METACHAR_block" value="block"></td>
                        </tr>
                            
                        <tr>
                            <td>VIOL_PARAMETER_VALUE_REGEXP</td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_REGEXP_alarm" name="VIOL_PARAMETER_VALUE_REGEXP_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_PARAMETER_VALUE_REGEXP_block" name="VIOL_PARAMETER_VALUE_REGEXP_block" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_POST_DATA_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_POST_DATA_LENGTH_alarm" name="VIOL_POST_DATA_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_POST_DATA_LENGTH_block" name="VIOL_POST_DATA_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_QUERY_STRING_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_QUERY_STRING_LENGTH_alarm" name="VIOL_QUERY_STRING_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_QUERY_STRING_LENGTH_block" name="VIOL_QUERY_STRING_LENGTH" value="block"></td>
                        </tr>

                        <tr>
                            <td>VIOL_RATING_THREAT</td>
                            <td><input type="checkbox" id="VIOL_RATING_THREAT_alarm" name="VIOL_RATING_THREAT_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_RATING_THREAT_block" name="VIOL_RATING_THREAT_block" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_RATING_NEED_EXAMINATION</td>
                            <td><input type="checkbox" id="VIOL_RATING_NEED_EXAMINATION_alarm" name="VIOL_RATING_NEED_EXAMINATION_alarm" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_RATING_NEED_EXAMINATION_block" name="VIOL_RATING_NEED_EXAMINATION_block" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_REQUEST_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_REQUEST_LENGTH_alarm" name="VIOL_REQUEST_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_REQUEST_LENGTH_block" name="VIOL_REQUEST_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_REQUEST_MAX_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_REQUEST_MAX_LENGTH_alarm" name="VIOL_REQUEST_MAX_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_REQUEST_MAX_LENGTH_block" name="VIOL_REQUEST_MAX_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_URL</td>
                            <td><input type="checkbox" id="VIOL_URL_alarm" name="VIOL_URL" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_URL_block" name="VIOL_URL" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_URL_CONTENT_TYPE</td>
                            <td><input type="checkbox" id="VIOL_URL_CONTENT_TYPE_alarm" name="VIOL_URL_CONTENT_TYPE" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_URL_CONTENT_TYPE_block" name="VIOL_URL_CONTENT_TYPE" value="block"></td>
                        </tr>
                        <tr>
                            <td>VIOL_URL_LENGTH</td>
                            <td><input type="checkbox" id="VIOL_URL_LENGTH_alarm" name="VIOL_URL_LENGTH" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_URL_LENGTH_block" name="VIOL_URL_LENGTH" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_URL_METACHAR</td>
                            <td><input type="checkbox" id="VIOL_URL_METACHAR_alarm" name="VIOL_URL_METACHAR" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_URL_METACHAR_block" name="VIOL_URL_METACHAR" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_XML_FORMAT</td>
                            <td><input type="checkbox" id="VIOL_XML_FORMAT_alarm" name="VIOL_XML_FORMAT" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_XML_FORMAT_block" name="VIOL_XML_FORMAT" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_XML_MALFORMED</td>
                            <td><input type="checkbox" id="VIOL_XML_MALFORMED_alarm" name="VIOL_XML_MALFORMED" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_XML_MALFORMED_block" name="VIOL_XML_MALFORMED" value="block"></td>
                        </tr>
                        
                        <tr>
                            <td>VIOL_THREAT_CAMPAIGN</td>
                            <td><input type="checkbox" id="VIOL_THREAT_CAMPAIGN_alarm" name="VIOL_THREAT_CAMPAIGN" value="alarm" checked></td>
                            <td><input type="checkbox" id="VIOL_THREAT_CAMPAIGN_block" name="VIOL_THREAT_CAMPAIGN" value="block" checked></td>
                        </tr>                        
                    </tbody>
                </table>
                
                <div id='http-protocols'>
                <h3>HTTP Protocol Checks [<a href="#" style="text-decoration: none;" onclick="javascript:document.getElementById('httpProtocolsTable').style.display = 'block';return false;">+</a>]</h3>
                <table id="httpProtocolsTable" class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Enabled</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>POST request with Content-Length: 0</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_1" name="HTTP_PROTOCOLS[]" value="POST request with Content-Length: 0" checked></td>
                        </tr>
                        <tr>
                            <td>Multiple host headers</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_2" name="HTTP_PROTOCOLS[]" value="Multiple host headers" checked></td>
                        </tr>
                        <tr>
                            <td>Host header contains IP address</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_3" name="HTTP_PROTOCOLS[]" value="Host header contains IP address" checked></td>
                        </tr>
                        <tr>
                            <td>Null in request</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_4" name="HTTP_PROTOCOLS[]" value="Null in request" checked></td>
                        </tr>
                        <tr>
                            <td>Header name with no header value</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_5" name="HTTP_PROTOCOLS[]" value="Header name with no header value" checked></td>
                        </tr>
                        <tr>
                            <td>Chunked request with Content-Length header</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_6" name="HTTP_PROTOCOLS[]" value="Chunked request with Content-Length header" checked></td>
                        </tr>
                        <tr>
                            <td>Check maximum number of parameters</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_7" name="HTTP_PROTOCOLS[]" value="Check maximum number of parameters" checked></td>
                        </tr>
                        <tr>
                            <td>Check maximum number of headers</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_8" name="HTTP_PROTOCOLS[]" value="Check maximum number of headers" checked></td>
                        </tr>
                        <tr>
                            <td>Body in GET or HEAD requests</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_9" name="HTTP_PROTOCOLS[]" value="Body in GET or HEAD requests" checked></td>
                        </tr>
                        <tr>
                            <td>Bad multipart/form-data request parsing</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_10" name="HTTP_PROTOCOLS[]" value="Bad multipart/form-data request parsing" checked></td>
                        </tr>
                        <tr>
                            <td>Bad multipart parameters parsing</td>
                            <td><input type="checkbox" id="HTTP_PROTOCOLS_11" name="HTTP_PROTOCOLS[]" value="Bad multipart parameters parsing" checked></td>
                        </tr>
                    </tbody>
                </table>
                </div>

                <div id="attack-signatures">
                    <h3>Attack Signatures</h3>
                    <table id='attack-signatures-table' class="w3-table w3-bordered w3-hoverable">
                        <thead>
                            <tr>
                                <th>Signatures</th>
                                <th>Block</th>
                                <th>Alarm</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="attack-signatures-row">
                                <td>
                                    <select id="ATTACK_SIGNATURES_name" name="ATTACK_SIGNATURES_name">
                                        <option name="All Signatures">All Signatures</option>
                                        <option name="High Accuracy Signatures" selected>High Accuracy Signatures</option>
                                        <option name="Predictable Resource Location Signatures">Predictable Resource Location Signatures</option>
                                        <option name="Remote File Include Signatures">Remote File Include Signatures</option>
                                        <option name="Information Leakage Signatures">Information Leakage Signatures</option>
                                        <option name="Server Side Code Injection Signatures">Server Side Code Injection Signatures</option>
                                        <option name="Command Execution Signatures">Command Execution Signatures</option>
                                        <option name="XPath Injection Signatures">XPath Injection Signatures</option>
                                        <option name="Path Traversal Signatures">Path Traversal Signatures</option>
                                        <option name="OS Command Injection Signatures">OS Command Injection Signatures</option>
                                        <option name="Cross Site Scripting Signatures">Cross Site Scripting Signatures</option>
                                        <option name="SQL Injection Signatures">SQL Injection Signatures</option>
                                        <option name="Directory Indexing Signatures">Directory Indexing Signatures</option>
                                        <option name="Authentication/Authorization Attack Signatures">Authentication/Authorization Attack Signatures</option>
                                        <option name="Buffer Overflow Signatures">Buffer Overflow Signatures</option>
                                        <option name="Denial of Service Signatures">Denial of Service Signatures</option>
                                        <option name="Vulnerability Scan Signatures">Vulnerability Scan Signatures</option>
                                        <option name="CVE Signatures">CVE Signatures</option>
                                        <option name="XML External Entities (XXE) Signatures">XML External Entities (XXE) Signatures</option>
                                    </select>
                                </td>
                                <td><input type="checkbox" name="ATTACK_SIGNATURES_block" value="" checked></td>
                                <td><input type="checkbox" name="ATTACK_SIGNATURES_alarm" value="" checked></td>
                                <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=deleteRow value="Delete" onclick="javascript:this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)"></td>
                            </tr>
                            <tr>
                                <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=add value="Add" onclick="addrow('attack-signatures-row','attack-signatures-table')"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="bot-defence">
                    <h3>Bot Defense</h3>
                    <label><b>Bot Defense</b></label>
                    <select class="w3-input w3-border" name="botDefense" id="botDefense" onchange="javascript:if (this.value == 'enabled') {document.getElementById('bot-defense-table').style.display='inline'} else {document.getElementById('bot-defense-table').style.display='none'}">
                        <option value="enabled">Enabled</option>
                        <option value="disabled" selected>Disabled</option>
                    </select>
                <table id='bot-defense-table' class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Trusted</th>
                            <th>Untrusted</th>
                            <th>Malicious</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><select class="w3-input w3-border" name="botDefenseTrusted" id="bot-defense-trusted-bot">
                                <option value="ignore">Ignore</option>
                                <option value="detect" selected>Detect</option>
                                <option value="alarm">Alarm</option>
                                <option value="block">Block</option>
                            </select></td>
                            <td><select class="w3-input w3-border" name="botDefenseUntrusted" id="bot-defense-untrusted-bot">
                                <option value="ignore">Ignore</option>
                                <option value="detect">Detect</option>
                                <option value="alarm" selected>Alarm</option>
                                <option value="block">Block</option>
                            </select></td>
                            <td><select class="w3-input w3-border" name="botDefenseMalicious" id="bot-defense-malicious-bot">
                                <option value="ignore">Ignore</option>
                                <option value="detect">Detect</option>
                                <option value="alarm">Alarm</option>
                                <option value="block" selected>Block</option>
                            </select></td>
                        </tr>
                    </tbody>
                </table>
                </div>
                <div id="server-technologies">
                    <h3>Server Technologies</h3>
                    <label><b>Server Technologies</b></label>
                    <select class="w3-input w3-border" name="serverTechnologies" id="serverTechnologies" onchange="javascript:if (this.value == 'enabled') {document.getElementById('server-technologies-table').style.display='inline'} else {document.getElementById('server-technologies-table').style.display='none'}">
                        <option value="enabled">Enabled</option>
                        <option value="disabled" selected>Disabled</option>
                    </select>
                <table id='server-technologies-table' class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Technology</th>
                            <th>Description</th>
                            <th>Enabled</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jenkins</td>
                            <td>Jenkins is an open source automation server written in Java. Jenkins helps to automate the non-human part of the software development process, with continuous integration and facilitating technical aspects of continuous delivery. It is a server-based system that runs in servlet containers such as Apache Tomcat.</td>
                            <td><input type="checkbox" name="jenkins" value=""></td>
                        </tr>
                        <tr>
                            <td>SharePoint</td>
                            <td>SharePoint is a web-based collaborative platform that integrates with Microsoft Office. Launched in 2001, SharePoint is primarily sold as a document management and storage system, but the product is highly configurable and usage varies substantially among organizations.</td>
                            <td><input type="checkbox" name="sharepoint" value=""></td>
                        </tr>
                        <tr>
                            <td>Oracle Application Server</td>
                            <td>Oracle Internet Application Server provides a single integrated packaged solution of for middleware infrastructure including Oracle Containers for J2EE, Oracle Web Cache, Oracle HTTP Server, Oracle Forms, Oracle Reports, Oracle Portal and Oracle Discoverer.</td>
                            <td><input type="checkbox" name="oracleapplicationserver" value=""></td>
                        </tr>
                        <tr>
                            <td>Python</td>
                            <td>Python is an interpreted, high-level, general-purpose programming language. Created by Guido van Rossum and first released in 1991, Python has a design philosophy that emphasizes code readability, notably using significant whitespace. It provides constructs that enable clear programming on both small and large scales.</td>
                            <td><input type="checkbox" name="python" value=""></td>
                        </tr>
                        <tr>
                            <td>Oracle Identity Manager</td>
                            <td>Oracle Identity Manager (OIM) enables enterprises to manage the entire user lifecycle across all enterprise resources both within and beyond a firewall. Within Oracle Identity Management it provides a mechanism for implementing the user-management aspects of a corporate policy.</td>
                            <td><input type="checkbox" name="oracleidentitymanager" value=""></td>
                        </tr>
                        <tr>
                            <td>Spring Boot</td>
                            <td>Spring Boot makes it easy to create Spring-powered, production-grade applications and services with absolute minimum fuss. It takes an opinionated view of the Spring platform so that new and existing users can quickly get to the bits they need.</td>
                            <td><input type="checkbox" name="springboot" value=""></td>
                        </tr>
                        <tr>
                            <td>CouchDB</td>
                            <td>Apache CouchDB is open source database software that focuses on ease of use and having a scalable architecture.</td>
                            <td><input type="checkbox" name="couchdb" value=""></td>
                        </tr>
                        <tr>
                            <td>SQLite</td>
                            <td>SQLite is a relational database management system contained in a C programming library. In contrast to many other database management systems, SQLite is not a client-server database engine. Rather, it is embedded into the end program.</td>
                            <td><input type="checkbox" name="sqlite" value=""></td>
                        </tr>
                        <tr>
                            <td>Handlebars</td>
                            <td>Handlebars provides the power necessary to let you build semantic templates effectively with no frustration.</td>
                            <td><input type="checkbox" name="handlebars" value=""></td>
                        </tr>
                        <tr>
                            <td>Mustache</td>
                            <td>Mustache is a simple web template system.</td>
                            <td><input type="checkbox" name="mustache" value=""></td>
                        </tr>
                        <tr>
                            <td>Prototype</td>
                            <td>Prototype takes the complexity out of client-side web programming. Built to solve real-world problems, it adds useful extensions to the browser scripting environment and provides elegant APIs around the clumsy interfaces of Ajax and the Document Object Model.</td>
                            <td><input type="checkbox" name="prototype" value=""></td>
                        </tr>
                        <tr>
                            <td>Zend</td>
                            <td>Zend Server is a complete and certified PHP distribution stack fully maintained and supported by Zend Technologies. It ships with an updated set of advanced value-add features designed to optimize productivity, performance, scalability and reliability.</td>
                            <td><input type="checkbox" name="zend" value=""></td>
                        </tr>
                        <tr>
                            <td>Redis</td>
                            <td>Redis is an open source in-memory data structure project implementing a distributed, in-memory key-value database with optional durability. Redis supports different kinds of abstract data structures, such as strings, lists, maps, sets, sorted sets, hyperloglogs, bitmaps, streams and spatial indexes.</td>
                            <td><input type="checkbox" name="redis" value=""></td>
                        </tr>
                        <tr>
                            <td>Underscore.js</td>
                            <td>Underscore.js is a JavaScript library which provides utility functions for common programming tasks. It is comparable to features provided by Prototype.js and the Ruby language, but opts for a functional programming design instead of extending object prototypes</td>
                            <td><input type="checkbox" name="underscore.js" value=""></td>
                        </tr>
                        <tr>
                            <td>Ember.js</td>
                            <td>Ember.js is an open source JavaScript web framework, based on the Model-view-viewmodel pattern. It allows developers to create scalable single-page web applications by incorporating common idioms and best practices into the framework.</td>
                            <td><input type="checkbox" name="ember.js" value=""></td>
                        </tr>
                        <tr>
                            <td>ZURB Foundation</td>
                            <td>Foundation is a responsive front-end framework. Foundation provides a responsive grid and HTML and CSS UI components, templates, and code snippets, including typography, forms, buttons, navigation and other interface elements, as well as optional functionality provided by JavaScript extensions. Foundation is maintained by ZURB and is an open source project.</td>
                            <td><input type="checkbox" name="zurbfoundation" value=""></td>
                        </tr>
                        <tr>
                            <td>Vue.js</td>
                            <td>Vue.js is an open source JavaScript framework for building user interfaces and single-page applications.</td>
                            <td><input type="checkbox" name="vue.js" value=""></td>
                        </tr>
                        <tr>
                            <td>UIKit</td>
                            <td>UIkit is a lightweight and modular front-end framework for developing fast and powerful web interfaces.</td>
                            <td><input type="checkbox" name="uikit" value=""></td>
                        </tr>
                        <tr>
                            <td>TYPO3 CMS</td>
                            <td>TYPO3 is a free and open source web content management system written in PHP. It is released under the GNU General Public License. It can run on several web servers, such as Apache or IIS, on top of many operating systems, among them Linux, Microsoft Windows, FreeBSD, macOS and OS/2.</td>
                            <td><input type="checkbox" name="typo3cms" value=""></td>
                        </tr>
                        <tr>
                            <td>RequireJS</td>
                            <td>RequireJS is a JavaScript library and file loader which manages the dependencies between JavaScript files and in modular programming. It also helps to improve the speed and quality of the code.</td>
                            <td><input type="checkbox" name="requirejs" value=""></td>
                        </tr>
                        <tr>
                            <td>React</td>
                            <td>React is a JavaScript library for building user interfaces. It is maintained by Facebook and a community of individual developers and companies. React can be used as a base in the development of single-page or mobile applications.</td>
                            <td><input type="checkbox" name="react" value=""></td>
                        </tr>
                        <tr>
                            <td>MooTools</td>
                            <td>MooTools is a lightweight, object-oriented JavaScript framework. It is released under the free, open source MIT License.</td>
                            <td><input type="checkbox" name="mootools" value=""></td>
                        </tr>
                        <tr>
                            <td>Laravel</td>
                            <td>Laravel is a free, open source PHP web framework, created by Taylor Otwell and intended for the development of web applications following the model-view-controller architectural pattern and based on Symfony.</td>
                            <td><input type="checkbox" name="laravel" value=""></td>
                        </tr>
                        <tr>
                            <td>GraphQL</td>
                            <td>GraphQL is an open source data query and manipulation language for APIs, and a runtime for fulfilling queries with existing data. GraphQL was developed internally by Facebook in 2012 before being publicly released in 2015.</td>
                            <td><input type="checkbox" name="graphql" value=""></td>
                        </tr>
                        <tr>
                            <td>Google Web Toolkit</td>
                            <td>Google Web Toolkit, or GWT Web Toolkit, is an open source set of tools that allows web developers to create and maintain complex JavaScript front-end applications in Java. Other than a few native libraries, everything is Java source that can be built on any supported platform with the included GWT Ant build files.</td>
                            <td><input type="checkbox" name="googlewebtoolkit" value=""></td>
                        </tr>
                        <tr>
                            <td>Express.js</td>
                            <td>Express.js, or simply Express, is a web application framework for Node.js, released as free and open source software under the MIT License. It is designed for building web applications and APIs. It has been called the de facto standard server framework for Node.js.</td>
                            <td><input type="checkbox" name="express.js" value=""></td>
                        </tr>
                        <tr>
                            <td>CodeIgniter</td>
                            <td>CodeIgniter is an open source software rapid development web framework, for use in building dynamic web sites with PHP.</td>
                            <td><input type="checkbox" name="codeigniter" value=""></td>
                        </tr>
                        <tr>
                            <td>Backbone.js</td>
                            <td>Backbone.js is a JavaScript library with a RESTful JSON interface and is based on the Model-view-presenter application design paradigm. Backbone is known for being lightweight, as its only hard dependency is on one JavaScript library, Underscore.js, plus jQuery for use of the full library.</td>
                            <td><input type="checkbox" name="backbone.js" value=""></td>
                        </tr>
                        <tr>
                            <td>AngularJS</td>
                            <td>AngularJS is a JavaScript-based open source front-end web application framework mainly maintained by Google and by a community of individuals and corporations to address many of the challenges encountered in developing single-page applications.</td>
                            <td><input type="checkbox" name="angularjs" value=""></td>
                        </tr>
                        <tr>
                            <td>JavaScript</td>
                            <td>JavaScript, often abbreviated as JS, is a high-level, interpreted programming language that conforms to the ECMAScript specification. It is a language which is also characterized as dynamic, weakly typed, prototype-based and multi-paradigm.</td>
                            <td><input type="checkbox" name="javascript" value=""></td>
                        </tr>
                        <tr>
                            <td>NGINX</td>
                            <td>NGINX is a web server which can also be used as a reverse proxy, load balancer, mail proxy and HTTP cache.</td>
                            <td><input type="checkbox" name="nginx" value=""></td>
                        </tr>
                        <tr>
                            <td>Jetty</td>
                            <td>Jetty is a Java HTTP (Web) server and Java Servlet container</td>
                            <td><input type="checkbox" name="jetty" value=""></td>
                        </tr>
                        <tr>
                            <td>Joomla</td>
                            <td>Joomla is a free and open source content management system (CMS) for publishing web content.</td>
                            <td><input type="checkbox" name="joomla" value=""></td>
                        </tr>
                        <tr>
                            <td>JavaServer Faces (JSF)</td>
                            <td>JavaServer Faces (JSF) is a Java specification for building component-based user interfaces for web applications.</td>
                            <td><input type="checkbox" name="javaserverfaces(jsf)" value=""></td>
                        </tr>
                        <tr>
                            <td>Ruby</td>
                            <td>Ruby is a dynamic, reflective, object-oriented, general-purpose programming language.</td>
                            <td><input type="checkbox" name="ruby" value=""></td>
                        </tr>
                        <tr>
                            <td>MongoDB</td>
                            <td>MongoDB is a free and open source cross-platform document-oriented database program.</td>
                            <td><input type="checkbox" name="mongodb" value=""></td>
                        </tr>
                        <tr>
                            <td>Django</td>
                            <td>Django is a free and open source web framework, written in Python, which follows the model-view-template (MVT) architectural pattern.</td>
                            <td><input type="checkbox" name="django" value=""></td>
                        </tr>
                        <tr>
                            <td>Node.js</td>
                            <td>Node.js is an open source, cross-platform JavaScript runtime environment for developing a diverse variety of tools and applications.</td>
                            <td><input type="checkbox" name="node.js" value=""></td>
                        </tr>
                        <tr>
                            <td>Citrix</td>
                            <td>Citrix Systems, Inc. is an American multinational software company that provides server, application and desktop virtualization, networking, software as a service (SaaS), and cloud computing technologies.</td>
                            <td><input type="checkbox" name="citrix" value=""></td>
                        </tr>
                        <tr>
                            <td>JBoss</td>
                            <td>The JBoss Enterprise Application Platform (or JBoss EAP) is a subscription-based/open source Java EE-based application server runtime platform used for building, deploying, and hosting highly-transactional Java applications and services.</td>
                            <td><input type="checkbox" name="jboss" value=""></td>
                        </tr>
                        <tr>
                            <td>Elasticsearch</td>
                            <td>Elasticsearch is a search engine based on Lucene.</td>
                            <td><input type="checkbox" name="elasticsearch" value=""></td>
                        </tr>
                        <tr>
                            <td>Apache Struts</td>
                            <td>Apache Struts is an open source web application framework for developing Java EE web applications.</td>
                            <td><input type="checkbox" name="apachestruts" value=""></td>
                        </tr>
                        <tr>
                            <td>XML</td>
                            <td>Extensible Markup Language (XML) is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine-readable.</td>
                            <td><input type="checkbox" name="xml" value=""></td>
                        </tr>
                        <tr>
                            <td>PostgreSQL</td>
                            <td>PostgreSQL, often simply Postgres, is an object-relational database (ORDBMS) - i.e., an RDBMS, with additional (optional use) &quot;object&quot; features - with an emphasis on extensibility and standards-compliance.</td>
                            <td><input type="checkbox" name="postgres" value=""></td>
                        </tr>
                        <tr>
                            <td>IBM DB2</td>
                            <td>IBM DB2 contains database server products developed by IBM.</td>
                            <td><input type="checkbox" name="ibmdb2" value=""></td>
                        </tr>
                        <tr>
                            <td>Sybase/ASE</td>
                            <td>SAP ASE (Adaptive Server Enterprise), originally known as Sybase SQL Server, and also commonly known as Sybase DB or ASE, is a relational model database server product for businesses developed by Sybase Corporation which became part of SAP AG.</td>
                            <td><input type="checkbox" name="sybase/ase" value=""></td>
                        </tr>
                        <tr>
                            <td>CGI</td>
                            <td>Common Gateway Interface (CGI) offers a standard protocol for web servers to interface with executable programs running on a server that generate web pages dynamically.</td>
                            <td><input type="checkbox" name="cgi" value=""></td>
                        </tr>
                        <tr>
                            <td>Proxy Servers</td>
                            <td>A proxy server is a server (a computer system or an application) that acts as an intermediary for requests from clients seeking resources from other servers.</td>
                            <td><input type="checkbox" name="proxyservers" value=""></td>
                        </tr>
                        <tr>
                            <td>SSI (Server Side Includes)</td>
                            <td>Server Side Includes (SSI) is a simple interpreted server-side scripting language used almost exclusively for the Web.</td>
                            <td><input type="checkbox" name="ssi(serversideincludes)" value=""></td>
                        </tr>
                        <tr>
                            <td>Cisco</td>
                            <td>Cisco Systems, Inc. is an American multinational corporation technology company headquartered in San Jose, California, that designs, manufactures and sells networking equipment worldwide.</td>
                            <td><input type="checkbox" name="cisco" value=""></td>
                        </tr>
                        <tr>
                            <td>Novell</td>
                            <td>Novell Directory Services (NDS) is a popular software product for managing access to computer resources and keeping track of the users of a network, such as a company&rsquo;s intranet, from a single point of administration.</td>
                            <td><input type="checkbox" name="novell" value=""></td>
                        </tr>
                        <tr>
                            <td>Macromedia JRun</td>
                            <td>JRun is a J2EE application server, originally developed in 1997 as a Java Servlet engine by Live Software and subsequently purchased by Allaire, who brought out the first J2EE compliant version.</td>
                            <td><input type="checkbox" name="macromediajrun" value=""></td>
                        </tr>
                        <tr>
                            <td>BEA Systems WebLogic Server</td>
                            <td>Oracle WebLogic Server is a Java EE application server currently developed by Oracle Corporation.</td>
                            <td><input type="checkbox" name="beasystemsweblogicserver" value=""></td>
                        </tr>
                        <tr>
                            <td>Lotus Domino</td>
                            <td>IBM Notes and IBM Domino are the client and server, respectively, of a collaborative client-server software platform sold by IBM.</td>
                            <td><input type="checkbox" name="lotusdomino" value=""></td>
                        </tr>
                        <tr>
                            <td>MySQL</td>
                            <td>MySQL is an open source relational database management system (RDBMS).</td>
                            <td><input type="checkbox" name="mysql" value=""></td>
                        </tr>
                        <tr>
                            <td>Oracle</td>
                            <td>Oracle Database (commonly referred to as Oracle RDBMS or simply as Oracle) is an object-relational database management system produced and marketed by Oracle Corporation.</td>
                            <td><input type="checkbox" name="oracle" value=""></td>
                        </tr>
                        <tr>
                            <td>Microsoft SQL Server</td>
                            <td>Microsoft SQL Server is a relational database management system developed by Microsoft.</td>
                            <td><input type="checkbox" name="microsoftsqlserver" value=""></td>
                        </tr>
                        <tr>
                            <td>PHP</td>
                            <td>PHP is a server-side scripting language designed primarily for web development but is also used as a general-purpose programming language.</td>
                            <td><input type="checkbox" name="php" value=""></td>
                        </tr>
                        <tr>
                            <td>Outlook Web Access</td>
                            <td>Outlook on the web (previously called Exchange Web Connect, Outlook Web Access, and Outlook Web App in Office 365 and Exchange Server 2013) is a personal information manager web app from Microsoft.</td>
                            <td><input type="checkbox" name="outlookwebaccess" value=""></td>
                        </tr>
                        <tr>
                            <td>Apache/NCSA HTTP Server</td>
                            <td>The Apache HTTP Server, colloquially called Apache, is the world&rsquo;s most used web server software.</td>
                            <td><input type="checkbox" name="apache/ncsahttpserver" value=""></td>
                        </tr>
                        <tr>
                            <td>Apache Tomcat</td>
                            <td>Apache Tomcat, often referred to as Tomcat, is an open source Java Servlet Container developed by the Apache Software Foundation (ASF).</td>
                            <td><input type="checkbox" name="apachetomcat" value=""></td>
                        </tr>
                        <tr>
                            <td>WordPress</td>
                            <td>WordPress is a free and open source content management system (CMS) based on PHP and MySQL.</td>
                            <td><input type="checkbox" name="wordpress" value=""></td>
                        </tr>
                        <tr>
                            <td>Macromedia ColdFusion</td>
                            <td>Adobe ColdFusion is a commercial rapid web application development platform created by JJ Allaire in 1995.</td>
                            <td><input type="checkbox" name="macromediacoldfusion" value=""></td>
                        </tr>
                        <tr>
                            <td>Unix/Linux</td>
                            <td>Unix is a family of multitasking, multiuser computer operating systems that derive from the original AT&amp;T Unix, developed in the 1970s at the Bell Labs research center by Ken Thompson, Dennis Ritchie, and others.</td>
                            <td><input type="checkbox" name="unix/linux" value=""></td>
                        </tr>
                        <tr>
                            <td>Microsoft Windows</td>
                            <td>Microsoft Windows (or simply Windows) is a meta-family of graphical operating systems developed, marketed, and sold by Microsoft.</td>
                            <td><input type="checkbox" name="microsoftwindows" value=""></td>
                        </tr>
                        <tr>
                            <td>ASP.NET</td>
                            <td>ASP.NET is an open source server-side web application framework designed for web development to produce dynamic web pages.</td>
                            <td><input type="checkbox" name="asp.net" value=""></td>
                        </tr>
                        <tr>
                            <td>Front Page Server Extensions (FPSE)</td>
                            <td>FrontPage Server Extensions are a software technology that allows Microsoft FrontPage clients to communicate with web servers, and provide additional functionality intended for websites.</td>
                            <td><input type="checkbox" name="frontpageserverextensions(fpse)" value=""></td>
                        </tr>
                        <tr>
                            <td>IIS</td>
                            <td>Internet Information Services (IIS, formerly Internet Information Server) is an extensible web server created by Microsoft for use with Windows NT family.</td>
                            <td><input type="checkbox" name="iis" value=""></td>
                        </tr>
                        <tr>
                            <td>WebDAV</td>
                            <td>Web Distributed Authoring and Versioning (WebDAV) is an extension of the Hypertext Transfer Protocol (HTTP) that allows clients to perform remote Web content authoring operations.</td>
                            <td><input type="checkbox" name="webdav" value=""></td>
                        </tr>
                        <tr>
                            <td>ASP</td>
                            <td>Active Server Pages (ASP), later known as Classic ASP or ASP Classic, is Microsoft&rsquo;s first server-side script engine for dynamically generated web pages.</td>
                            <td><input type="checkbox" name="asp" value=""></td>
                        </tr>
                        <tr>
                            <td>Java Servlets/JSP</td>
                            <td>A Java servlet is a Java program that extends the capabilities of a server.</td>
                            <td><input type="checkbox" name="jsp" value=""></td>
                        </tr>
                            <tr>
                            <td>jQuery</td>
                            <td>jQuery is a cross-platform JavaScript library designed to simplify the client-side scripting of HTML.</td>
                            <td><input type="checkbox" name="jquery" value=""></td>
                        </tr>
                    </tbody>
                </table>
                </div>

                <div id="filetypes">
                    <h3>File Types</h3>
                    <label><b>File Types</b></label>
                    <select class="w3-input w3-border" name="fileTypes" id="fileTypes" onchange="javascript:if (this.value == 'enabled') {document.getElementById('file-types-table').style.display='inline'} else {document.getElementById('file-types-table').style.display='none'}">
                        <option value="enabled">Enabled</option>
                        <option value="disabled" selected>Disabled</option>
                    </select>
                <table id='file-types-table' class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Allowed</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="file-types-row">
                            <td><input type="text" value="*"></td>
                            <td><select>
                                <option value="wildcard" selected>Wildcard</option>
                                <option value="explicit">Explicit</option>
                            </select></td>
                            <td><input type="checkbox" value="" checked></td>
                            <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=deleteRow value="Delete" onclick="javascript:this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)"></td>
                        </tr>
                        <tr>
                            <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=add value="Add" onclick="addrow('file-types-row','file-types-table')"></td>
                        </tr>
                    </tbody>
                </table>
                </div>


                <div id="urls">
                    <h3>URLs</h3>
                    <label><b>URLs</b></label>
                    <select class="w3-input w3-border" name="urls" id="urls" onchange="javascript:if (this.value == 'enabled') {document.getElementById('urls-table').style.display='inline'} else {document.getElementById('urls-table').style.display='none'}">
                        <option value="enabled">Enabled</option>
                        <option value="disabled" selected>Disabled</option>
                    </select>
                <table id='urls-table' class="w3-table w3-bordered w3-hoverable" style="display:none">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Allowed</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="urls-row">
                            <td><input type="text" value="*"></td>
                            <td><select>
                                <option value="wildcard" selected>Wildcard</option>
                                <option value="explicit">Explicit</option>
                            </select></td>
                            <td><input type="checkbox" value="" checked></td>
                            <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=deleteRow value="Delete" onclick="javascript:this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)"></td>
                        </tr>
                        <tr>
                            <td><input class="w3-button w3-round w3-border w3-border-white" type=button name=add value="Add" onclick="addrow('urls-row','urls-table')"></td>
                        </tr>
                    </tbody>
                </table>
                </div>

                <br/>
                <input class="w3-button w3-round w3-border w3-border-white" type=button name=submit value="Create Policy" onclick="createpolicy()">
                <input disabled id="exportButton"  class="w3-button w3-round w3-border w3-border-white" type="button" onclick="export2txt()" value="Export Policy">
                <a href="https://docs.nginx.com/nginx-app-protect/policy/" class="w3-button" target="_blank">Policy Help</a>
                <a href="https://docs.nginx.com/nginx-app-protect/configuration/" class="w3-button" target="_blank">Configuration Guide</a>
                
            </form>
            
        </div>
    </div>
</div>

<pre id="output" class="w3-code"></pre>




<script>
function createpolicy() {
    var policyDict = {}
    policyDict['name'] = document.forms["policyConfig"]['policyName'].value
    policyDict['description'] = document.forms["policyConfig"]['policyDescription'].value
    policyDict['template'] = { "name": "POLICY_TEMPLATE_NGINX_BASE" }
    policyDict['applicationLanguage'] = document.forms["policyConfig"]['policyApplicationLanguage'].value
    policyDict['enforcementMode'] = document.forms["policyConfig"]['policyEnforcementMode'].value
    
    // bot defense
    if (document.forms["policyConfig"]['botDefense'].value == "enabled") {
        policyDict['bot-defense'] = {"settings": {"isEnabled":true},
        "mitigations": {"classes":[
            {"name":"trusted-bot","action":document.forms["policyConfig"]['botDefenseTrusted'].value},
            {"name":"untrusted-bot","action":document.forms["policyConfig"]['botDefenseUntrusted'].value},
            {"name":"malicious-bot","action":document.forms["policyConfig"]['botDefenseMalicious'].value}]}}
    }
    // Server Technologies
    if (document.forms["policyConfig"]['serverTechnologies'].value == "enabled") {
        var table = document.getElementById('server-technologies-table');
        arrayEnabled = []
        for (let row of table.tBodies[0].rows) {
            if (row.cells[2].getElementsByTagName('input')[0].checked) {
                technologyName = row.cells[0].innerHTML
                arrayEnabled.push({"serverTechnologyName": technologyName})
            }
        }
        policyDict['server-technologies'] = arrayEnabled
    }
    // File Types
    if (document.forms["policyConfig"]['fileTypes'].value == "enabled") {
        var table = document.getElementById('file-types-table');
        arrayEnabled = []
        for (let row of table.tBodies[0].rows) {
            if (row.id.startsWith('file-types-row')) {
                //console.log(row)
                arrayEnabled.push({
                    "name": row.cells[0].getElementsByTagName('input')[0].value,
                    "type": row.cells[1].getElementsByTagName('select')[0].value,
                    "allowed": row.cells[2].getElementsByTagName('input')[0].checked,
                });
            }
        }
        policyDict['filetypes'] = arrayEnabled
    }

    // URLs
    if (document.forms["policyConfig"]['urls'].value == "enabled") {
        var table = document.getElementById('urls-table');
        arrayEnabled = []
        for (let row of table.tBodies[0].rows) {
            if (row.id.startsWith('urls-row')) {
                //console.log(row)
                arrayEnabled.push({
                    "name": row.cells[0].getElementsByTagName('input')[0].value,
                    "type": row.cells[1].getElementsByTagName('select')[0].value,
                    "allowed": row.cells[2].getElementsByTagName('input')[0].checked,
                });
            }
        }
        policyDict['urls'] = arrayEnabled
    }

    // manage violations
    violations = []
    violationNames = [  'VIOL_ASM_COOKIE_MODIFIED',
                        //'VIOL_ATTACK_SIGNATURE',
                        'VIOL_BLACKLISTED_IP',
                        'VIOL_COOKIE_EXPIRED',
                        'VIOL_COOKIE_LENGTH',
                        'VIOL_COOKIE_MALFORMED',
                        'VIOL_COOKIE_MODIFIED',
                        'VIOL_DATA_GUARD',
                        'VIOL_ENCODING',
                        'VIOL_EVASION',
                        'VIOL_FILETYPE',
                        'VIOL_HEADER_LENGTH',
                        'VIOL_HEADER_METACHAR',
                        'VIOL_HTTP_PROTOCOL',
                        'VIOL_HTTP_RESPONSE_STATUS',
                        'VIOL_JSON_FORMAT',
                        'VIOL_JSON_MALFORMED',
                        'VIOL_METHOD',
                        'VIOL_POST_DATA_LENGTH',
                        'VIOL_QUERY_STRING_LENGTH',
                        'VIOL_REQUEST_LENGTH',
                        'VIOL_REQUEST_MAX_LENGTH',
                        'VIOL_URL_LENGTH',
                        'VIOL_URL_METACHAR',
                        'VIOL_XML_FORMAT',
                        'VIOL_XML_MALFORMED',
                        'VIOL_RATING_THREAT',
                        'VIOL_RATING_NEED_EXAMINATION',
                        'VIOL_PARAMETER_MULTIPART_NULL_VALUE',
                        'VIOL_PARAMETER_NAME_METACHAR',
                        'VIOL_PARAMETER_VALUE_METACHAR'
                    ]
    violationNames.forEach( (v) => {
        violations.push({   'name': v,
                            'alarm': document.getElementById(v + "_alarm")['checked'],
                            'block': document.getElementById(v + "_block")['checked']
                        })
    });
       
    httpProtocols = []
    document.getElementsByName('HTTP_PROTOCOLS[]').forEach( (i) => {
        if (i.checked) {
            a = { 'description': i.value, 'enabled': true }
        } else {
            a = { 'description': i.value, 'enabled': false }
        }
        httpProtocols.push(a)

    });
    

    policyDict['blocking-settings'] = {'violations': violations, 'http-protocols': httpProtocols}
    //
    var globalDict = { 'policy': policyDict }
    // now enable the export button
    document.getElementById("exportButton").disabled = false;
    document.getElementById("output").innerHTML = JSON.stringify(globalDict,undefined,4);
       
    return false
}


</script>

</body>
</html>